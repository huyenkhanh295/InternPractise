var tableCustomer = {
  JSONData: [
    {
      Name: 'Otto Clay',
      Age: 61,
      Country: 6,
      Address: 'Ap #897-1459 Quam Avenue',
      Married: false,
    },
    {
      Name: 'Connor Johnston',
      Age: 73,
      Country: 7,
      Address: 'Ap #370-4647 Dis Av.',
      Married: false,
    },
    {
      Name: 'Lacey Hess',
      Age: 29,
      Country: 7,
      Address: 'Ap #365-8835 Integer St.',
      Married: false,
    },
    {
      Name: 'Timothy Henson',
      Age: 78,
      Country: 1,
      Address: '911-5143 Luctus Ave',
      Married: false,
    },
    {
      Name: 'Ramona Benton',
      Age: 43,
      Country: 5,
      Address: 'Ap #614-689 Vehicula Street',
      Married: true,
    },
    {
      Name: 'Ezra Tillman',
      Age: 51,
      Country: 1,
      Address: 'P.O. Box 738, 7583 Quisque St.',
      Married: true,
    },
    {
      Name: 'Dante Carter',
      Age: 59,
      Country: 1,
      Address: 'P.O. Box 976, 6316 Lorem, St.',
      Married: false,
    },
    {
      Name: 'Christopher Mcclure',
      Age: 58,
      Country: 1,
      Address: '847-4303 Dictum Av.',
      Married: true,
    },
    {
      Name: 'Ruby Rocha',
      Age: 62,
      Country: 2,
      Address: '5212 Sagittis Ave',
      Married: false,
    },
    {
      Name: 'Imelda Hardin',
      Age: 39,
      Country: 5,
      Address: '719-7009 Auctor Av.',
      Married: false,
    },
    {
      Name: 'Jonah Johns',
      Age: 28,
      Country: 5,
      Address: 'P.O. Box 939, 9310 A Ave',
      Married: false,
    },
    {
      Name: 'Herman Rosa',
      Age: 49,
      Country: 7,
      Address: '718-7162 Molestie Av.',
      Married: true,
    },
    {
      Name: 'Arthur Gay',
      Age: 20,
      Country: 7,
      Address: '5497 Neque Street',
      Married: false,
    },
    {
      Name: 'Xena Wilkerson',
      Age: 63,
      Country: 1,
      Address: 'Ap #303-6974 Proin Street',
      Married: true,
    },
    {
      Name: 'Lilah Atkins',
      Age: 33,
      Country: 5,
      Address: '622-8602 Gravida Ave',
      Married: true,
    },
    {
      Name: 'Malik Shepard',
      Age: 59,
      Country: 1,
      Address: '967-5176 Tincidunt Av.',
      Married: false,
    },
    {
      Name: 'Keely Silva',
      Age: 24,
      Country: 1,
      Address: 'P.O. Box 153, 8995 Praesent Ave',
      Married: false,
    },
    {
      Name: 'Hunter Pate',
      Age: 73,
      Country: 7,
      Address: 'P.O. Box 771, 7599 Ante, Road',
      Married: false,
    },
    {
      Name: 'Mikayla Roach',
      Age: 55,
      Country: 5,
      Address: 'Ap #438-9886 Donec Rd.',
      Married: true,
    },
    {
      Name: 'Upton Joseph',
      Age: 48,
      Country: 4,
      Address: 'Ap #896-7592 Habitant St.',
      Married: true,
    },
    {
      Name: 'Jeanette Pate',
      Age: 59,
      Country: 2,
      Address: 'P.O. Box 177, 7584 Amet, St.',
      Married: false,
    },
    {
      Name: 'Kaden Hernandez',
      Age: 79,
      Country: 3,
      Address: '366 Ut St.',
      Married: true,
    },
    {
      Name: 'Kenyon Stevens',
      Age: 20,
      Country: 3,
      Address: 'P.O. Box 704, 4580 Gravida Rd.',
      Married: false,
    },
    {
      Name: 'Jerome Harper',
      Age: 31,
      Country: 5,
      Address: '2464 Porttitor Road',
      Married: false,
    },
    {
      Name: 'Jelani Patel',
      Age: 36,
      Country: 2,
      Address: 'P.O. Box 541, 5805 Nec Av.',
      Married: true,
    },
    {
      Name: 'Keaton Oconnor',
      Age: 21,
      Country: 1,
      Address: 'Ap #657-1093 Nec, Street',
      Married: false,
    },
    {
      Name: 'Bree Johnston',
      Age: 31,
      Country: 2,
      Address: '372-5942 Vulputate Avenue',
      Married: false,
    },
    {
      Name: 'Maisie Hodges',
      Age: 70,
      Country: 7,
      Address: 'P.O. Box 445, 3880 Odio, Rd.',
      Married: false,
    },
    {
      Name: 'Kuame Calhoun',
      Age: 39,
      Country: 2,
      Address: 'P.O. Box 609, 4105 Rutrum St.',
      Married: true,
    },
    {
      Name: 'Carlos Cameron',
      Age: 38,
      Country: 5,
      Address: 'Ap #215-5386 A, Avenue',
      Married: false,
    },
    {
      Name: 'Fulton Parsons',
      Age: 25,
      Country: 7,
      Address: 'P.O. Box 523, 3705 Sed Rd.',
      Married: false,
    },
    {
      Name: 'Wallace Christian',
      Age: 43,
      Country: 3,
      Address: '416-8816 Mauris Avenue',
      Married: true,
    },
    {
      Name: 'Caryn Maldonado',
      Age: 40,
      Country: 1,
      Address: '108-282 Nonummy Ave',
      Married: false,
    },
    {
      Name: 'Whilemina Frank',
      Age: 20,
      Country: 7,
      Address: 'P.O. Box 681, 3938 Egestas. Av.',
      Married: true,
    },
    {
      Name: 'Emery Moon',
      Age: 41,
      Country: 4,
      Address: 'Ap #717-8556 Non Road',
      Married: true,
    },
    {
      Name: 'Price Watkins',
      Age: 35,
      Country: 4,
      Address: '832-7810 Nunc Rd.',
      Married: false,
    },
    {
      Name: 'Lydia Castillo',
      Age: 59,
      Country: 7,
      Address: '5280 Placerat, Ave',
      Married: true,
    },
    {
      Name: 'Lawrence Conway',
      Age: 53,
      Country: 1,
      Address: 'Ap #452-2808 Imperdiet St.',
      Married: false,
    },
    {
      Name: 'Kalia Nicholson',
      Age: 67,
      Country: 5,
      Address: 'P.O. Box 871, 3023 Tellus Road',
      Married: true,
    },
    {
      Name: 'Brielle Baxter',
      Age: 45,
      Country: 3,
      Address: 'Ap #822-9526 Ut, Road',
      Married: true,
    },
    {
      Name: 'Valentine Brady',
      Age: 72,
      Country: 7,
      Address: '8014 Enim. Road',
      Married: true,
    },
    {
      Name: 'Rebecca Gardner',
      Age: 57,
      Country: 4,
      Address: '8655 Arcu. Road',
      Married: true,
    },
    {
      Name: 'Vladimir Tate',
      Age: 26,
      Country: 1,
      Address: '130-1291 Non, Rd.',
      Married: true,
    },
    {
      Name: 'Vernon Hays',
      Age: 56,
      Country: 4,
      Address: '964-5552 In Rd.',
      Married: true,
    },
    {
      Name: 'Allegra Hull',
      Age: 22,
      Country: 4,
      Address: '245-8891 Donec St.',
      Married: true,
    },
    {
      Name: 'Hu Hendrix',
      Age: 65,
      Country: 7,
      Address: '428-5404 Tempus Ave',
      Married: true,
    },
    {
      Name: 'Kenyon Battle',
      Age: 32,
      Country: 2,
      Address: '921-6804 Lectus St.',
      Married: false,
    },
    {
      Name: 'Gloria Nielsen',
      Age: 24,
      Country: 4,
      Address: 'Ap #275-4345 Lorem, Street',
      Married: true,
    },
    {
      Name: 'Illiana Kidd',
      Age: 59,
      Country: 2,
      Address: '7618 Lacus. Av.',
      Married: false,
    },
    {
      Name: 'Adria Todd',
      Age: 68,
      Country: 6,
      Address: '1889 Tincidunt Road',
      Married: false,
    },
    {
      Name: 'Kirsten Mayo',
      Age: 71,
      Country: 1,
      Address: '100-8640 Orci, Avenue',
      Married: false,
    },
    {
      Name: 'Willa Hobbs',
      Age: 60,
      Country: 6,
      Address: 'P.O. Box 323, 158 Tristique St.',
      Married: false,
    },
    {
      Name: 'Alexis Clements',
      Age: 69,
      Country: 5,
      Address: 'P.O. Box 176, 5107 Proin Rd.',
      Married: false,
    },
    {
      Name: 'Akeem Conrad',
      Age: 60,
      Country: 2,
      Address: '282-495 Sed Ave',
      Married: true,
    },
    {
      Name: 'Montana Silva',
      Age: 79,
      Country: 6,
      Address: 'P.O. Box 120, 9766 Consectetuer St.',
      Married: false,
    },
    {
      Name: 'Kaseem Hensley',
      Age: 77,
      Country: 6,
      Address: 'Ap #510-8903 Mauris. Av.',
      Married: true,
    },
    {
      Name: 'Christopher Morton',
      Age: 35,
      Country: 5,
      Address: 'P.O. Box 234, 3651 Sodales Avenue',
      Married: false,
    },
    {
      Name: 'Wade Fernandez',
      Age: 49,
      Country: 6,
      Address: '740-5059 Dolor. Road',
      Married: true,
    },
    {
      Name: 'Illiana Kirby',
      Age: 31,
      Country: 2,
      Address: '527-3553 Mi Ave',
      Married: false,
    },
    {
      Name: 'Kimberley Hurley',
      Age: 65,
      Country: 5,
      Address: 'P.O. Box 637, 9915 Dictum St.',
      Married: false,
    },
    {
      Name: 'Arthur Olsen',
      Age: 74,
      Country: 5,
      Address: '887-5080 Eget St.',
      Married: false,
    },
    {
      Name: 'Brody Potts',
      Age: 59,
      Country: 2,
      Address: 'Ap #577-7690 Sem Road',
      Married: false,
    },
    {
      Name: 'Dillon Ford',
      Age: 60,
      Country: 1,
      Address: 'Ap #885-9289 A, Av.',
      Married: true,
    },
    {
      Name: 'Hannah Juarez',
      Age: 61,
      Country: 2,
      Address: '4744 Sapien, Rd.',
      Married: true,
    },
    {
      Name: 'Vincent Shaffer',
      Age: 25,
      Country: 2,
      Address: '9203 Nunc St.',
      Married: true,
    },
    {
      Name: 'George Holt',
      Age: 27,
      Country: 6,
      Address: '4162 Cras Rd.',
      Married: false,
    },
    {
      Name: 'Tobias Bartlett',
      Age: 74,
      Country: 4,
      Address: '792-6145 Mauris St.',
      Married: true,
    },
    {
      Name: 'Xavier Hooper',
      Age: 35,
      Country: 1,
      Address: '879-5026 Interdum. Rd.',
      Married: false,
    },
    {
      Name: 'Declan Dorsey',
      Age: 31,
      Country: 2,
      Address: 'Ap #926-4171 Aenean Road',
      Married: true,
    },
    {
      Name: 'Clementine Tran',
      Age: 43,
      Country: 4,
      Address: 'P.O. Box 176, 9865 Eu Rd.',
      Married: true,
    },
    {
      Name: 'Pamela Moody',
      Age: 55,
      Country: 6,
      Address: '622-6233 Luctus Rd.',
      Married: true,
    },
    {
      Name: 'Julie Leon',
      Age: 43,
      Country: 6,
      Address: 'Ap #915-6782 Sem Av.',
      Married: true,
    },
    {
      Name: 'Shana Nolan',
      Age: 79,
      Country: 5,
      Address: 'P.O. Box 603, 899 Eu St.',
      Married: false,
    },
    {
      Name: 'Vaughan Moody',
      Age: 37,
      Country: 5,
      Address: '880 Erat Rd.',
      Married: false,
    },
    {
      Name: 'Randall Reeves',
      Age: 44,
      Country: 3,
      Address: '1819 Non Street',
      Married: false,
    },
    {
      Name: 'Dominic Raymond',
      Age: 68,
      Country: 1,
      Address: 'Ap #689-4874 Nisi Rd.',
      Married: true,
    },
    {
      Name: 'Lev Pugh',
      Age: 69,
      Country: 5,
      Address: 'Ap #433-6844 Auctor Avenue',
      Married: true,
    },
    {
      Name: 'Desiree Hughes',
      Age: 80,
      Country: 4,
      Address: '605-6645 Fermentum Avenue',
      Married: true,
    },
    {
      Name: 'Idona Oneill',
      Age: 23,
      Country: 7,
      Address: '751-8148 Aliquam Avenue',
      Married: true,
    },
    {
      Name: 'Lani Mayo',
      Age: 76,
      Country: 1,
      Address: '635-2704 Tristique St.',
      Married: true,
    },
    {
      Name: 'Cathleen Bonner',
      Age: 40,
      Country: 1,
      Address: '916-2910 Dolor Av.',
      Married: false,
    },
    {
      Name: 'Sydney Murray',
      Age: 44,
      Country: 5,
      Address: '835-2330 Fringilla St.',
      Married: false,
    },
    {
      Name: 'Brenna Rodriguez',
      Age: 77,
      Country: 6,
      Address: '3687 Imperdiet Av.',
      Married: true,
    },
    {
      Name: 'Alfreda Mcdaniel',
      Age: 38,
      Country: 7,
      Address: '745-8221 Aliquet Rd.',
      Married: true,
    },
    {
      Name: 'Zachery Atkins',
      Age: 30,
      Country: 1,
      Address: '549-2208 Auctor. Road',
      Married: true,
    },
    {
      Name: 'Amelia Rich',
      Age: 56,
      Country: 4,
      Address: 'P.O. Box 734, 4717 Nunc Rd.',
      Married: false,
    },
    {
      Name: 'Kiayada Witt',
      Age: 62,
      Country: 3,
      Address: 'Ap #735-3421 Malesuada Avenue',
      Married: false,
    },
    {
      Name: 'Lysandra Pierce',
      Age: 36,
      Country: 1,
      Address: 'Ap #146-2835 Curabitur St.',
      Married: true,
    },
    {
      Name: 'Cara Rios',
      Age: 58,
      Country: 4,
      Address: 'Ap #562-7811 Quam. Ave',
      Married: true,
    },
    {
      Name: 'Austin Andrews',
      Age: 55,
      Country: 7,
      Address: 'P.O. Box 274, 5505 Sociis Rd.',
      Married: false,
    },
    {
      Name: 'Lillian Peterson',
      Age: 39,
      Country: 2,
      Address: '6212 A Avenue',
      Married: false,
    },
    {
      Name: 'Adria Beach',
      Age: 29,
      Country: 2,
      Address: 'P.O. Box 183, 2717 Nunc Avenue',
      Married: true,
    },
    {
      Name: 'Oleg Durham',
      Age: 80,
      Country: 4,
      Address: '931-3208 Nunc Rd.',
      Married: false,
    },
    {
      Name: 'Casey Reese',
      Age: 60,
      Country: 4,
      Address: '383-3675 Ultrices, St.',
      Married: false,
    },
    {
      Name: 'Kane Burnett',
      Age: 80,
      Country: 1,
      Address: '759-8212 Dolor. Ave',
      Married: false,
    },
    {
      Name: 'Stewart Wilson',
      Age: 46,
      Country: 7,
      Address: '718-7845 Sagittis. Av.',
      Married: false,
    },
    {
      Name: 'Charity Holcomb',
      Age: 31,
      Country: 6,
      Address: '641-7892 Enim. Ave',
      Married: false,
    },
    {
      Name: 'Kyra Cummings',
      Age: 43,
      Country: 4,
      Address: 'P.O. Box 702, 6621 Mus. Av.',
      Married: false,
    },
    {
      Name: 'Stuart Wallace',
      Age: 25,
      Country: 7,
      Address: '648-4990 Sed Rd.',
      Married: true,
    },
    {
      Name: 'Carter Clarke',
      Age: 59,
      Country: 6,
      Address: 'Ap #547-2921 A Street',
      Married: false,
    },
  ],
  countryData: [
    { Name: '', Id: 0 },
    { Name: 'United States', Id: 1 },
    { Name: 'Canada', Id: 2 },
    { Name: 'United Kingdom', Id: 3 },
    { Name: 'France', Id: 4 },
    { Name: 'Brazil', Id: 5 },
    { Name: 'China', Id: 6 },
    { Name: 'Russia', Id: 7 },
  ],
  sortHeader: {
    Name: 0,
    Age: 0,
    Address: 0,
    Country: 0,
    Married: 0,
    choose: '',
  },
  showSearchRow: false,
  page: 1,
  size: 5,
  currentPage: 1,
  totalRecord: 0,
  totalPage: 0,
  isEdit: true,
  isSearchAll: false,
  itemEdit: {},
  currentData: [],
  searchData: [],

  init() {
    this.totalRecord = this.JSONData.length;
    this.totalPage = Math.ceil(this.totalRecord / this.size);
    this.currentData = this.JSONData;
    this.initData();
    this.initEvents();
  },

  initData() {
    this.renderTableHeader();
    this.renderSearch();
    this.loadData(this.size, this.page);
    this.renderPageNumber(this.totalPage);
  },

  initEvents() {
    // this.sortByHeader("Name");
  },

  setCurrentData(data) {
    this.currentData = data;
  },

  renderTableHeader() {
    document.getElementById(
      'row-header'
    ).innerHTML = `<th class="col col-header" id="header-name" onclick="tableCustomer.sortByHeader('Name')">Name</th>
                        <th class="col col-header" id="header-age" onclick="tableCustomer.sortByHeader('Age')">Age</th>
                        <th class="col col-header" id="header-address" onclick="tableCustomer.sortByHeader('Address')">Address</th>
                        <th class="col col-header" id="header-country" onclick="tableCustomer.sortByHeader('Country')">Country</th>
                        <th class="col col-header" id="header-married" onclick="tableCustomer.sortByHeader('Married')">Is Married</th>
                        <th class="col col-header" id="header-action" >
                          <span class="icon icon-search" id="show-search-row">&#128269;</span>
                        </th>`;
  },

  renderSearch() {
    document.getElementById(
      'row-search'
    ).innerHTML = `<td class="col col-search search-name">
                      <input class="input-control" type="text" id="input-search-name" title="Filter by name" oninput="tableCustomer.filterByName(this.value)"/>
                    </td>
                    <td class="col col-search search-age">
                      <input class="input-control" type="number" min=0 id="input-search-age" title="Filter by age" oninput="tableCustomer.filterByAge(this.value)"/>
                    </td>
                    <td class="col col-search search-address">
                      <input class="input-control" type="text" id="input-search-address" title="Filter by address" oninput="tableCustomer.filterByAddress(this.value)"/>
                    </td>
                    <td class="col col-search search-country">
                      <select class="input-control" id="input-search-country" title="Filter by country" oninput="tableCustomer.filterByCountry(this.value)">
                      </select>
                    </td>
                    <td class="col col-search search-is-married">
                      <input class="input-control" type="checkbox" id="input-search-married" title="Filter by is married" onclick="tableCustomer.filterByMarried(this)"/>
                    </td>
                    <td class="col col-search">
                      <span class="icon icon-search" onclick="tableCustomer.searchAll()">&#128269;</span>
                      <span class="icon icon-delete">&#128465;</span>
                    </td>
                    `;
    this.renderSearchRowCountry();
    document.getElementById('row-search').style.display = 'none';
    document
      .getElementById('show-search-row')
      .addEventListener('click', function () {
        if (!this.showSearchRow) {
          document.getElementById('row-search').style.display = '';
          this.showSearchRow = true;
        } else {
          document.getElementById('row-search').style.display = 'none';
          this.showSearchRow = false;
          this.loadData(this.size,this.page);
        }
      });
  },

  loadData(size, page) {
    this.totalRecord = this.currentData.length;
    this.totalPage = Math.ceil(this.totalRecord / this.size);
    let start = size * (page - 1);
    let end = size * page;
    this.renderTableBody(start, end);

    document.getElementById(
      'current-page'
    ).innerHTML = `${page} of ${this.totalPage}`;
    this.page = page;
    this.renderPageNumber(this.totalPage);
  },

  renderTableBody(start, end) {
    let render = document.getElementById('table-body');
    render.innerHTML = '';
    if (this.currentData.length < end) {
      end = this.currentData.length;
    }
    for (let i = start; i < end; i++) {
      render.innerHTML += `<tr class="row" id="item-${i}"></tr>`;
      this.renderItem(i, this.currentData[i]);
    }
  },

  renderPageNumber(totalPage) {
    let render = document.getElementById('page-number');
    render.innerHTML = '';
    let pageBefore = `<a href="#" class="first-page" id="go-to-first-page" onclick="tableCustomer.loadData(tableCustomer.size,1)">First</a><a href="#" class="previous-page" id="go-to-previous-page" onclick="tableCustomer.loadData(tableCustomer.size,${this.page}-1)">Previous</a>`;
    let pageAfter = `<a href="#" class="next-page" id="go-to-next-page" onclick="tableCustomer.loadData(tableCustomer.size,${this.page}+1)">Next</a><a href="#" class="last-page" id="go-to-last-page" onclick="tableCustomer.loadData(tableCustomer.size,tableCustomer.totalPage)">Last</a>`;
    let dot = '<a href="#">...</a>';
    let pageNumber = '';
    if (totalPage <= 5) {
      for (let page = 1; page <= totalPage; page++) {
        pageNumber += `<a href="#" class="page-link" id="page-${page}" onclick="tableCustomer.loadData(tableCustomer.size, ${page})">${page}</a>`;
      }
      if (this.page == 1) {
        render.innerHTML += pageNumber + pageAfter;
      } else if (this.page == totalPage) {
        render.innerHTML += pageBefore + pageNumber;
      } else {
        render.innerHTML += pageBefore + pageNumber + pageAfter;
      }
    } else {
      if (this.page <= 3) {
        for (let page = 1; page <= 5; page++)
          pageNumber += `<a href="#" class="page-link" id="page-${page}" onclick="tableCustomer.loadData(tableCustomer.size, ${page})">${page}</a>`;
        render.innerHTML += pageNumber + dot + pageAfter;
      } else if (this.page >= totalPage - 2) {
        for (let page = totalPage - 4; page <= totalPage; page++)
          pageNumber += `<a href="#" class="page-link" id="page-${page}" onclick="tableCustomer.loadData(tableCustomer.size, ${page})">${page}</a>`;
        render.innerHTML += pageBefore + dot + pageNumber;
      } else {
        for (let page = this.page - 2; page <= this.page + 2; page++)
          pageNumber += `<a href="#" class="page-link" id="page-${page}" onclick="tableCustomer.loadData(tableCustomer.size, ${page})">${page}</a>`;
        render.innerHTML += pageBefore + dot + pageNumber + dot + pageAfter;
      }
    }
  },

  renderEditRow(index, item) {
    const itemEdit = document.getElementById(`item-${index}`);
    itemEdit.style.backgroundColor = '#fcffda';
    itemEdit.textContent = '';
    itemEdit.innerHTML += `<td class="col col-name" >
                              <input class="input-control" id="name-idx-${index}" type="text" value="${
      item.Name
    }"
                            </td>
                            <td class="col col-age">
                              <input class="input-control"  style="text-align: center;" id="age-idx-${index}" type="text" value="${
      item.Age
    }">
                            </td>
                            <td class="col col-address">
                              <input class="input-control" id="address-idx-${index}" type="text" value="${
      item.Address
    }">
                            </td>
                            <td class="col col-country">
                              <select class="input-control" id="country-idx-${index}">
                              </select>
                            </td>
                            <td class="col col-is-married">
                              ${this.getIsMarriedStatusOnEdit(
                                item.Married,
                                index
                              )}
                            </td>
                            <td class="col col-action">
                              <span class="icon icon-confirm" onclick="tableCustomer.saveItem(${index})">&#10004;</span>
                              <span class="icon icon-cancel" onclick="tableCustomer.cancelEdit(${index})">&#10006;</span></td>
                            </td>`;
    this.renderEditRowCountry(item, index);
  },

  renderEditRowCountry(item, index) {
    const col = document.getElementById(`country-idx-${index}`);
    for (country of this.countryData) {
      if (item.Country == country.Id) {
        col.innerHTML += `<option value="${country.Id}" selected>${country.Name}</option>`;
      } else
        col.innerHTML += `<option value="${country.Id}">${country.Name}</option>`;
    }
  },

  renderSearchRowCountry() {
    const col = document.getElementById('input-search-country');
    for (country of this.countryData) {
      col.innerHTML += `<option>${country.Name}</option>`;
    }
  },

  editItem(index) {
    if (this.isEdit) {
      this.itemEdit = this.currentData[index];
      this.isEdit = false;
      this.renderEditRow(index, this.itemEdit);
    }
  },

  saveItem(index) {
    this.itemEdit.Name = document.getElementById(`name-idx-${index}`).value;
    this.itemEdit.Age = document.getElementById(`age-idx-${index}`).value;
    this.itemEdit.Address = document.getElementById(
      `address-idx-${index}`
    ).value;
    this.itemEdit.Country = document.getElementById(
      `country-idx-${index}`
    ).value;
    this.itemEdit.Married = false;
    if (document.getElementById(`married-idx-${index}`).checked) {
      this.itemEdit.Married = true;
    }
    this.cancelEdit(index);
  },

  deleteItem(index) {
    if (this.isEdit) {
      if (confirm('Do you want to delete this customer?')) {
        this.currentData.splice(index, 1);
        this.JSONData.splice(index, 1);
        let numberPage = this.currentData.length / this.size;
        //Delete from last page
        if (numberPage == this.page - 1) {
          this.page = numberPage;
        }
        this.loadData(this.size, this.page);
      }
    }
  },

  cancelEdit(index) {
    const itemEdit = document.getElementById(`item-${index}`);
    itemEdit.textContent = '';
    this.renderItem(index, this.itemEdit);
    itemEdit.style.backgroundColor = '';
    this.isEdit = true;
    this.itemEdit = {};
  },

  renderItem(index, item) {
    const itemRow = document.getElementById(`item-${index}`);
    itemRow.innerHTML += `<td class="col col-name" onclick="tableCustomer.editItem(${index})">
                              ${item.Name}
                            </td>
                            <td class="col col-age" onclick="tableCustomer.editItem(${index})">
                              ${item.Age}
                            </td>
                            <td class="col col-address" onclick="tableCustomer.editItem(${index})">
                            ${item.Address}
                            </td>
                            <td class="col col-country" onclick="tableCustomer.editItem(${index})">
                              ${this.getCountryName(item.Country)}
                            </td>
                            <td class="col col-is-married" onclick="tableCustomer.editItem(${index})">
                              ${this.getIsMarriedStatus(item.Married)}
                            </td>
                            <td class="col col-action">
                              <span class="icon icon-edit" onclick="tableCustomer.editItem(${index})">&#128397;</span>
                              <span class="icon icon-delete" onclick="tableCustomer.deleteItem(${index})">&#128465;</span></td>
                            </td>`;
  },

  sortByHeader(key) {
    if (key == 'Country') {
      this.JSONData.sort((a, b) => {
        return this.getCountryName(a[key]) > this.getCountryName(b[key])
          ? 1
          : -1;
      });
    } else {
      this.JSONData.sort((a, b) => {
        return a[key] > b[key] ? 1 : -1;
      });
    }
    if (this.sortHeader[key] < 1) {
      this.sortHeader[key] = 1;
    } else {
      this.JSONData.reverse();
      this.sortHeader[key] = -1;
    }
    this.sortHeader.choose = key;
    this.renderTableHeader();
    this.renderSortRow();
    this.renderSearch();
    this.loadData(this.size, this.page);
  },

  renderSortRow() {
    if (this.sortHeader.choose) {
      let title = document.getElementById(
        `header-${this.sortHeader.choose.toLowerCase()}`
      );
      let symbol =
        this.sortHeader[this.sortHeader.choose] < 1
          ? '<span class="icon icon-sort">&#11015;</span>'
          : '<span class="icon icon-sort">&#11014;</span>';
      title.innerHTML = `${symbol}&nbsp;${this.sortHeader.choose}`;
    }
  },

  getCountryName(id) {
    for (item of this.countryData) {
      if (item.Id == id) return item.Name;
    }
  },

  getIsMarriedStatusOnEdit(status, index) {
    if (status == true) {
      return `<input class="isMarried-checkbox" id="married-idx-${index}" type="checkbox" checked>`;
    } else {
      return `<input class="isMarried-checkbox" id="married-idx-${index}" type="checkbox">`;
    }
  },

  getIsMarriedStatus(status) {
    if (status) {
      return `<input class="isMarried-checkbox" type="checkbox" value="true" checked disabled>`;
    } else {
      return `<input class="isMarried-checkbox" type="checkbox" value="false" disabled>`;
    }
  },

  filterByName(value) {
    if (this.isSearchAll) {
      this.currentData = this.currentData.filter((element) => {
        return element.Name.toLowerCase().includes(value.trim().toLowerCase());
      });
    } else {
      if (value == '') {
        this.currentData = this.JSONData;
      } else {
        this.currentData = this.JSONData.filter((element) => {
          return element.Name.toLowerCase().includes(
            value.trim().toLowerCase()
          );
        });
      }
    }
    this.loadData(this.size, this.page);
  },

  filterByAge(value) {
    if (this.isSearchAll && value!="") {
      this.currentData = this.currentData.filter(
        (element) => element.Age == value
      );
    } else {
      if (value == '') {
        this.currentData = this.JSONData;
      } else {
        this.currentData = this.JSONData.filter(
          (element) => element.Age == value
        );
      }
    }
    this.loadData(this.size, this.page);
  },

  filterByAddress(value) {
    if (this.isSearchAll) {
      this.currentData = this.currentData.filter((element) => {
        return element.Address.toLowerCase().includes(
          value.trim().toLowerCase()
        );
      });
    } else {
      if (value == '') {
        this.currentData = this.JSONData;
      } else {
        this.currentData = this.JSONData.filter((element) => {
          return element.Address.toLowerCase().includes(
            value.trim().toLowerCase()
          );
        });
      }
    }

    this.loadData(this.size, this.page);
  },

  filterByCountry(value) {
    if (this.isSearchAll) {
      this.currentData = this.currentData.filter((element) => {
        return this.getCountryName(element.Country)
          .toLowerCase()
          .includes(value.trim().toLowerCase());
      });
    } else {
      if (value == '') {
        this.currentData = this.JSONData;
      } else {
        this.currentData = this.JSONData.filter((element) => {
          return this.getCountryName(element.Country)
            .toLowerCase()
            .includes(value.trim().toLowerCase());
        });
      }
    }

    this.loadData(this.size, this.page);
  },

  filterByMarried(value) {
    if (this.isSearchAll) {
      if (value.checked) {
        this.currentData = this.currentData.filter(
          (element) => element.Married == true
        );
      } else {
        this.currentData = this.currentData.filter(
          (element) => element.Married == false
        );
      }
    } else {
      if (value.checked) {
        this.currentData = this.JSONData.filter(
          (element) => element.Married == true
        );
      } else {
        this.currentData = this.JSONData.filter(
          (element) => element.Married == false
        );
      }
    }

    this.loadData(this.size, this.page);
  },

  searchAll() {
    this.isSearchAll = true;
    this.currentData = this.JSONData;
    this.filterByName(document.getElementById('input-search-name').value);
    this.filterByAge(document.getElementById('input-search-age').value);
    this.filterByAddress(document.getElementById('input-search-address').value);
    this.filterByCountry(document.getElementById('input-search-country').value);
    this.filterByMarried(document.getElementById('input-search-married'));
    this.loadData(this.size, this.page);
    this.isSearchAll = false;
  },
};

function initTable() {
  tableCustomer.init();
}
